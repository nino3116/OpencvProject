{% extends "cam/base.html" %} {% block title %} 카메라 서버 관리 {% endblock %}
{% block content %}
<div class="container mt-4">
  <h2>카메라 서버 관리</h2>
  <div class="row">
    <div class="col-md-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">카메라 서버 1</h5>
          <p class="card-text">카메라 서버 1에 대한 설명입니다.</p>
          <button
            id="camera1-manage-btn"
            class="btn btn-primary"
            onclick="toggleCameraStream('camera1')"
          >
            관리
          </button>
          <div id="camera1-stream" class="mt-2"></div>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">카메라 서버 2</h5>
          <p class="card-text">카메라 서버 2에 대한 설명입니다.</p>
          <button
            id="camera2-manage-btn"
            class="btn btn-primary"
            onclick="toggleCameraStream('camera2')"
          >
            관리
          </button>
          <div id="camera2-stream" class="mt-2"></div>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">카메라 서버 3</h5>
          <p class="card-text">카메라 서버 3에 대한 설명입니다.</p>
          <button
            id="camera3-manage-btn"
            class="btn btn-primary"
            onclick="toggleCameraStream('camera3')"
          >
            관리
          </button>
          <div id="camera3-stream" class="mt-2"></div>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">카메라 서버 4</h5>
          <p class="card-text">카메라 서버 4에 대한 설명입니다.</p>
          <button
            id="camera4-manage-btn"
            class="btn btn-primary"
            onclick="toggleCameraStream('camera4')"
          >
            관리
          </button>
          <div id="camera4-stream" class="mt-2"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function toggleCameraStream(cameraId) {
    const streamDiv = document.getElementById(cameraId + "-stream");
    const buttonId = cameraId + "-manage-btn";
    const button = document.getElementById(buttonId);

    if (streamDiv.innerHTML === "") {
      const img = document.createElement("img");
      img.src = `/stream/${cameraId}`;
      img.style.width = "100%";
      streamDiv.appendChild(img);
      button.textContent = "닫기";
      button.onclick = function () {
        closeStream(cameraId);
      };
    } else {
      closeStream(cameraId);
    }
  }

  function closeStream(cameraId) {
    const streamDiv = document.getElementById(cameraId + "-stream");
    const buttonId = cameraId + "-manage-btn";
    const button = document.getElementById(buttonId);
    streamDiv.innerHTML = "";
    button.textContent = "관리";
    button.onclick = function () {
      toggleCameraStream(cameraId);
    };
  }
</script>
{% endblock %}
